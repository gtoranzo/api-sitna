{"version":3,"sources":["filter.js"],"names":["TC","filter","Filter","tagName","this","tagName_","_defaultNSURL","_defaultPrefixNS","_wfsPrefixNS","_fieldTitle","_wfsNSURL","_wfs2prefixNS","_wfs2NSURL","_wfs2FieldTitle","prototype","getTagName","writeFilterCondition_","format","prefix","NSURL","tag","inner","writeInnerCondition_","LogicalNary","write","ComparisonBinary","Comparison","Spatial","Function","writeInnerArrayCondition_","filters","parent","conditions","reduce","vi","va","index","getText","wfsVersion","parseFloat","and","params","concat","Array","slice","call","arguments","bind","apply","And","or","Or","not","condition","Not","intersects","Object","toString","Intersects","within","Within","equalTo","propertyName","expression","opt_matchCase","EqualTo","notEqualTo","NotEqualTo","lessThan","LessThan","lessThanOrEqualTo","LessThanOrEqualTo","greaterThan","GreaterThan","greaterThanOrEqualTo","GreaterThanOrEqualTo","isNull","IsNull","between","lowerBoundary","upperBoundary","IsBetween","functionName","like","pattern","opt_wildCard","opt_singleChar","opt_escapeChar","IsLike","inherit","values","LowerBoundary","UpperBoundary","Pattern","isArray","a","b","i","fmt","text","value","matchCase","escape","escapeChar","singleChar","wildCard","name","fieldTitle","undefined","_paramsToText","param","_text","attr","key","geometryName","geometry","opt_srsName","srsName","wrap","getAxisOrientation","match","code","def","ol","proj","get","axisOrientation_","toGML","bbox","Bbox","extent","lowerCorner","upperCorner","BBOX"],"mappings":"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","sourcesContent":["TC.filter = {};\r\n\r\nTC.filter.Filter = function (tagName) {\r\n    this.tagName_ = tagName;\r\n    \r\n    this._defaultNSURL = \"http://www.opengis.net/ogc\";\r\n    this._defaultPrefixNS = this._wfsPrefixNS = \"ogc\";\r\n    this._fieldTitle = \"PropertyName\";\r\n\r\n    this._defaultNSURL = this._wfsNSURL = \"http://www.opengis.net/ogc\";\r\n    this._wfs2prefixNS = \"fes\";\r\n    this._wfs2NSURL = \"http://www.opengis.net/fes/2.0\";\r\n    this._wfs2FieldTitle = \"ValueReference\";\r\n};\r\n\r\nTC.filter.Filter.prototype.getTagName = function () {\r\n    return this.tagName_;\r\n};\r\n\r\nTC.filter.Filter.prototype.writeFilterCondition_ = function () {\r\n\r\n    //return '<{prefix}:{tag}>{childs}</{prefix}:{tag}>'.format({prefix:\"ogc\",tag:filter.getTagName(),childs:\"\"});\r\n    var filter = this;\r\n    return '<{prefix}:Filter xmlns:{prefix}=\\\"{NSURL}\">{inner}</{prefix}:Filter>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        NSURL: this._defaultNSURL,\r\n        tag: filter.getTagName(),\r\n        inner: this.writeInnerCondition_(filter)\r\n    });\r\n\r\n    /*ol.xml.pushSerializeAndPop(item,\r\n        ol.format.WFS.GETFEATURE_SERIALIZERS_,\r\n        ol.xml.makeSimpleNodeFactory(filter.getTagName()),\r\n        [filter], objectStack);*/\r\n}\r\nTC.filter.Filter.prototype.writeInnerCondition_ = function (filter) {\r\n    if (filter != this) {\r\n        filter._defaultNSURL = this._defaultNSURL;\r\n        filter._defaultPrefixNS = this._defaultPrefixNS;\r\n        filter._fieldTitle = this._fieldTitle;\r\n    }\r\n\r\n    if (filter instanceof TC.filter.LogicalNary) {\r\n        return filter.write()\r\n    }\r\n    else if (filter instanceof TC.filter.ComparisonBinary) {\r\n        return filter.write();\r\n    }\r\n    else if (filter instanceof TC.filter.Comparison) {\r\n        return filter.write();\r\n    }\r\n    else if (filter instanceof TC.filter.Spatial) {\r\n        return filter.write();\r\n    }\r\n    else if (filter instanceof TC.filter.Function) {\r\n        return filter.write();\r\n    }\r\n    else\r\n        return filter.write();\r\n};\r\nTC.filter.Filter.prototype.writeInnerArrayCondition_ = function (filters) {\r\n    const parent = this;\r\n    return parent.conditions.reduce(function (vi, va, index) {\r\n        return (vi instanceof TC.filter.Filter ? parent.writeInnerCondition_(vi) : vi) + parent.writeInnerCondition_(va);\r\n    });\r\n}\r\n\r\nTC.filter.Filter.prototype.getText = function (wfsVersion) {\r\n    if (wfsVersion && parseFloat(wfsVersion,10) >= 2) {\r\n        this._defaultPrefixNS = this._wfs2prefixNS;\r\n        this._defaultNSURL = this._wfs2NSURL;\r\n        this._fieldTitle = this._wfs2FieldTitle;\r\n    }\r\n    return this.writeFilterCondition_();\r\n};\r\n\r\nTC.filter.and = function (conditions) {\r\n    var params = [null].concat(Array.prototype.slice.call(arguments));\r\n    return new (Function.prototype.bind.apply(TC.filter.And, params));\r\n};\r\n\r\nTC.filter.or = function (conditions) {\r\n    var params = [null].concat(Array.prototype.slice.call(arguments));\r\n    return new (Function.prototype.bind.apply(TC.filter.Or, params));\r\n};\r\n\r\nTC.filter.not = function (condition) {\r\n    return new TC.filter.Not(condition);\r\n};\r\n\r\n\r\nTC.filter.intersects = function () {\r\n    if (Object.prototype.toString.call(arguments[0]) !== \"[object String]\")\r\n        return new TC.filter.Intersects(null, arguments[0], arguments[1]);\r\n    else\r\n        return new TC.filter.Intersects(arguments[0], arguments[1], arguments[2]);\r\n};\r\n\r\n\r\nTC.filter.within = function () {\r\n    if (Object.prototype.toString.call(arguments[0]) !== \"[object String]\")\r\n        return new TC.filter.Within(null, arguments[0], arguments[1]);\r\n    else\r\n        return new TC.filter.Within(arguments[0], arguments[1], arguments[2]);\r\n};\r\n\r\n\r\nTC.filter.equalTo = function (propertyName, expression, opt_matchCase) {\r\n    return new TC.filter.EqualTo(propertyName, expression, opt_matchCase);\r\n};\r\n\r\nTC.filter.notEqualTo = function (propertyName, expression, opt_matchCase) {\r\n    return new TC.filter.NotEqualTo(propertyName, expression, opt_matchCase);\r\n};\r\n\r\nTC.filter.lessThan = function (propertyName, expression) {\r\n    return new TC.filter.LessThan(propertyName, expression);\r\n};\r\n\r\nTC.filter.lessThanOrEqualTo = function (propertyName, expression) {\r\n    return new TC.filter.LessThanOrEqualTo(propertyName, expression);\r\n};\r\n\r\nTC.filter.greaterThan = function (propertyName, expression) {\r\n    return new TC.filter.GreaterThan(propertyName, expression);\r\n};\r\n\r\nTC.filter.greaterThanOrEqualTo = function (propertyName, expression) {\r\n    return new TC.filter.GreaterThanOrEqualTo(propertyName, expression);\r\n};\r\n\r\nTC.filter.isNull = function (propertyName) {\r\n    return new TC.filter.IsNull(propertyName);\r\n};\r\n\r\nTC.filter.between = function (propertyName, lowerBoundary, upperBoundary) {\r\n    return new TC.filter.IsBetween(propertyName, lowerBoundary, upperBoundary);\r\n};\r\n\r\nTC.filter[\"function\"] = function (functionName, params) {\r\n    return new TC.filter.Function(functionName, params);\r\n};\r\n\r\nTC.filter.like = function (propertyName, pattern,\r\n    opt_wildCard, opt_singleChar, opt_escapeChar, opt_matchCase) {\r\n    return new TC.filter.IsLike(propertyName, pattern,\r\n        opt_wildCard, opt_singleChar, opt_escapeChar, opt_matchCase);\r\n};\r\n\r\nTC.filter.LogicalNary = function (tagName, conditions) {\r\n\r\n    TC.filter.Filter.call(this, tagName);\r\n\r\n    this.conditions = Array.prototype.slice.call(arguments, 1);\r\n};\r\nTC.inherit(TC.filter.LogicalNary, TC.filter.Filter);\r\n\r\nTC.filter.And = function (conditions) {\r\n    var params = ['And'].concat(Array.prototype.slice.call(arguments));\r\n    TC.filter.LogicalNary.apply(this, params);\r\n};\r\nTC.inherit(TC.filter.And, TC.filter.LogicalNary);\r\n\r\nTC.filter.Or = function (conditions) {\r\n    var params = ['Or'].concat(Array.prototype.slice.call(arguments));\r\n    TC.filter.LogicalNary.apply(this, params);\r\n};\r\nTC.inherit(TC.filter.Or, TC.filter.LogicalNary);\r\n\r\nTC.filter.LogicalNary.prototype.write = function () {\r\n    return '<{prefix}:{tag}>{inner}</{prefix}:{tag}>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        inner: this.writeInnerArrayCondition_()\r\n    });\r\n}\r\n\r\nTC.filter.Not = function (condition) {\r\n    this.condition = condition;\r\n    TC.filter.Filter.call(this, 'Not');\r\n    \r\n};\r\nTC.inherit(TC.filter.Not, TC.filter.Filter);\r\n\r\nTC.filter.Filter.prototype.write=function () {\r\n    return '<{prefix}:{tag}>{inner}</{prefix}:{tag}>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        inner: this.writeInnerCondition_(this.condition)\r\n    });\r\n}\r\n\r\nTC.filter.Comparison = function (tagName, propertyName) {\r\n\r\n    TC.filter.Filter.call(this, tagName);\r\n\r\n    this.propertyName = propertyName;\r\n};\r\nTC.inherit(TC.filter.Comparison, TC.filter.Filter);\r\n\r\nTC.filter.Comparison.prototype.write = function () {\r\n    var values = '';\r\n    //isbetween\r\n    if (this.lowerBoundary && this.upperBoundary)\r\n        values = '<{prefix}:LowerBoundary><{prefix}:Literal>{LowerBoundary}</{prefix}:Literal></{prefix}:LowerBoundary><{prefix}:UpperBoundary><{prefix}:Literal>{UpperBoundary}</{prefix}:Literal></{prefix}:UpperBoundary>'.format({\r\n            prefix:this._defaultPrefixNS,\r\n            LowerBoundary: this.lowerBoundary,\r\n            UpperBoundary: this.upperBoundary\r\n        });\r\n    if (this.pattern)\r\n        values = '<{prefix}:Literal>{Pattern}</{prefix}:Literal>'.format({\r\n            prefix: this._defaultPrefixNS,\r\n            Pattern: this.pattern\r\n        });\r\n    if (this.params)\r\n        if (Array.isArray(this.params))\r\n            values = this.params.reduce(function (a, b, i) {\r\n                var fmt = function (text) {\r\n                    return '<{prefix}:Literal>{value}</{prefix}:Literal>'.format({ prefix: this._defaultPrefixNS, value: text });\r\n                }\r\n                return (i > 0 ? a : fmt(a)) + fmt(b);\r\n            });\r\n        else\r\n            values = '<{prefix}:Literal>{value}</{prefix}:Literal>'.format({ prefix: this._defaultPrefixNS, value: this.params });\r\n\r\n    return '<{prefix}:{tag}{matchCase}{escape}{singleChar}{wildCard}><{prefix}:{fieldTitle}>{name}</{prefix}:{fieldTitle}>{values}</{prefix}:{tag}>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        matchCase: (typeof (this.matchCase) !== \"undefined\" ? \" matchCase=\\\"\" + this.matchCase + \"\\\"\" : \"\"),\r\n        escape: (typeof (this.escapeChar) !== \"undefined\" ? \" escape=\\\"\" + this.escapeChar + \"\\\"\" : \"\"),\r\n        singleChar: (typeof (this.singleChar) !== \"undefined\" ? \" singleChar=\\\"\" + this.singleChar + \"\\\"\" : \"\"),\r\n        wildCard: (typeof (this.wildCard) !== \"undefined\" ? \" wildCard=\\\"\" + this.wildCard + \"\\\"\" : \"\"),\r\n        name: this.propertyName,\r\n        values: values,\r\n        fieldTitle: this._fieldTitle\r\n    });\r\n}\r\n\r\nTC.filter.ComparisonBinary = function (\r\n    tagName, propertyName, expression, opt_matchCase) {\r\n\r\n    TC.filter.Comparison.call(this, tagName, propertyName);\r\n\r\n    this.expression = expression;\r\n\r\n    this.matchCase = opt_matchCase;\r\n};\r\nTC.inherit(TC.filter.ComparisonBinary, TC.filter.Comparison);\r\n\r\nTC.filter.ComparisonBinary.prototype.write = function () {\r\n    var _str = '<{prefix}:{tag}{matchCase}>' + (this.propertyName instanceof TC.filter.Filter ? '{name}' : '<{prefix}:{fieldTitle}>{name}</{prefix}:{fieldTitle}>') + '<{prefix}:Literal>{value}</{prefix}:Literal></{prefix}:{tag}>';\r\n    return _str.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        matchCase: (typeof (this.matchCase) !== \"undefined\" ? \" matchCase=\\\"\" + this.matchCase + \"\\\"\" : \"\"),\r\n        //escape:(typeof(this.escapeChar)!==\"undefined\"? \" escape=\\\"\" + this.escapeChar+ \"\\\"\":\"\"),\r\n        //singleChar:(typeof(this.singleChar)!==\"undefined\"? \" singleChar=\\\"\" + this.singleChar+ \"\\\"\":\"\"),\r\n        //wildCard:(typeof(this.wildCard)!==\"undefined\"? \" wildCard=\\\"\" + this.wildCard+ \"\\\"\":\"\"),\r\n        name: this.propertyName instanceof TC.filter.Filter ? this.propertyName.write() : this.propertyName,\r\n        value: this.expression,\r\n        fieldTitle: this._fieldTitle\r\n    });\r\n}\r\nTC.filter.EqualTo = function (propertyName, expression, opt_matchCase) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsEqualTo', propertyName, expression, opt_matchCase);\r\n};\r\nTC.inherit(TC.filter.EqualTo, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.GreaterThan = function (propertyName, expression) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsGreaterThan', propertyName, expression);\r\n};\r\nTC.inherit(TC.filter.GreaterThan, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.GreaterThanOrEqualTo = function (propertyName, expression) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsGreaterThanOrEqualTo', propertyName, expression);\r\n};\r\nTC.inherit(TC.filter.GreaterThanOrEqualTo, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.LessThan = function (propertyName, expression) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsLessThan', propertyName, expression);\r\n};\r\nTC.inherit(TC.filter.LessThan, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.LessThanOrEqualTo = function (propertyName, expression) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsLessThanOrEqualTo', propertyName, expression);\r\n};\r\nTC.inherit(TC.filter.LessThanOrEqualTo, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.NotEqualTo = function (propertyName, expression, opt_matchCase) {\r\n    TC.filter.ComparisonBinary.call(this, 'PropertyIsNotEqualTo', propertyName, expression, opt_matchCase);\r\n};\r\nTC.inherit(TC.filter.NotEqualTo, TC.filter.ComparisonBinary);\r\n\r\nTC.filter.IsLike = function (propertyName, pattern,\r\n    opt_wildCard, opt_singleChar, opt_escapeChar, opt_matchCase) {\r\n    TC.filter.Comparison.call(this, 'PropertyIsLike', propertyName);\r\n\r\n    this.pattern = pattern;\r\n\r\n    this.wildCard = (opt_wildCard !== undefined) ? opt_wildCard : '*';\r\n\r\n    this.singleChar = (opt_singleChar !== undefined) ? opt_singleChar : '.';\r\n\r\n    this.escapeChar = (opt_escapeChar !== undefined) ? opt_escapeChar : '!';\r\n\r\n    this.matchCase = opt_matchCase;\r\n};\r\nTC.inherit(TC.filter.IsLike, TC.filter.Comparison);\r\n\r\nTC.filter.IsNull = function (propertyName) {\r\n    TC.filter.Comparison.call(this, 'PropertyIsNull', propertyName);\r\n};\r\nTC.inherit(TC.filter.IsNull, TC.filter.Comparison);\r\n\r\nTC.filter.IsBetween = function (propertyName, lowerBoundary, upperBoundary) {\r\n    TC.filter.Comparison.call(this, 'PropertyIsBetween', propertyName);\r\n    this.lowerBoundary = lowerBoundary;\r\n    this.upperBoundary = upperBoundary;\r\n};\r\nTC.inherit(TC.filter.IsBetween, TC.filter.Comparison);\r\n\r\nTC.filter.Function = function (functionName, params) {\r\n    TC.filter.Filter.call(this, functionName);\r\n    this.params = params\r\n};\r\nTC.inherit(TC.filter.Function, TC.filter.Filter);\r\n\r\nTC.filter.Function.prototype.write = function () {\r\n    var values = '';\r\n    if (this.params) {\r\n        var _paramsToText = function (param, prefix) {\r\n            if (typeof (param) === \"string\") {\r\n                return '<{prefix}:Literal>{value}</{prefix}:Literal>'.format({ prefix: prefix, value: param });\r\n            }\r\n            if (typeof (param) === \"object\") {\r\n                var _text = '';\r\n                for (var attr in param) {\r\n                    _text = _text + '<{prefix}:{key}>{value}</{prefix}:{key}>'.format({ prefix: prefix, value: param[attr], key: attr })\r\n                }\r\n                return _text;\r\n            }\r\n        }\r\n        if (Array.isArray(this.params)) {\r\n            var prefix = this._defaultPrefixNS;\r\n            values = this.params.reduce(function (a, b, i) {\r\n                var fmt = function (param) {\r\n                    return _paramsToText(param, prefix);\r\n                }\r\n                return (i > 1 ? a : fmt(a)) + fmt(b);\r\n            });\r\n        }\r\n        else\r\n            values = _paramsToText(this.params, this._defaultPrefixNS);\r\n    }\r\n    return '<{prefix}:Function name=\"{tag}\">{inner}</{prefix}:Function>'.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        inner: values\r\n    });\r\n};\r\n\r\nTC.filter.Spatial = function (tagName, geometryName, geometry, opt_srsName) {\r\n    TC.filter.Filter.call(this, tagName);\r\n    this.geometryName = geometryName;\r\n    this.geometry = geometry;\r\n    this.srsName = opt_srsName;\r\n    this.wrap = new TC.wrap.Filter(this);\r\n};\r\n\r\nTC.wrap.Filter = function (filter) {\r\n    this.parent = filter;\r\n};\r\n\r\nTC.wrap.Filter.prototype.getAxisOrientation = function () {\r\n    // Establecemos el srsName a EPSG:xxxx o urn:x-ogc:def:crs:EPSG:xxxx dependiendo del orden de eje de coordenadas del CRS.\r\n    // Esto se debe a que GeoServer hace asunciones en el orden de los ejes dependiendo del formato de srsName que se use.\r\n    // Más información: https://docs.geoserver.org/latest/en/user/services/wfs/basics.html#wfs-basics-axis\r\n    var srsName = this.parent.srsName;\r\n    if (srsName) {\r\n        const match = srsName.match(/\\d{4,6}$/);\r\n        if (match) {\r\n            const code = match[0];\r\n            const def = ol.proj.get(srsName);\r\n            if (def) {\r\n                return ((def.axisOrientation_ === 'neu' ? 'urn:x-ogc:def:crs:EPSG:' : 'EPSG:') + code);\r\n            }\r\n        }\r\n    }\r\n    return srsName;\r\n};\r\n\r\nTC.inherit(TC.filter.Spatial, TC.filter.Filter);\r\n\r\nTC.filter.Spatial.prototype.write = function () {\r\n    var pattern = null;\r\n    if (this.geometryName) {\r\n        pattern = '<{prefix}:{tag}><{prefix}:{fieldTitle}>{name}</{prefix}:{fieldTitle}>{geometry}</{prefix}:{tag}>';\r\n    }\r\n    else {\r\n        pattern = '<{prefix}:{tag}><{prefix}:{fieldTitle}/>{geometry}</{prefix}:{tag}>';\r\n    }\r\n\r\n    return pattern.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        name: this.geometryName,\r\n        geometry: (this.geometry instanceof TC.filter.Function ? this.writeInnerCondition_(this.geometry) : this.geometry.wrap.toGML(undefined, this.wrap.getAxisOrientation())),\r\n        fieldTitle: this._fieldTitle\r\n    });\r\n};\r\n\r\nTC.filter.bbox = function () {\r\n    if (Object.prototype.toString.call(arguments[0]) !== \"[object String]\")\r\n        return new TC.filter.Bbox(null, arguments[0], arguments[1]);\r\n    else\r\n        return new TC.filter.Bbox(arguments[0], arguments[1], arguments[2]);\r\n};\r\n\r\nTC.filter.Bbox = function (geometryName, extent, opt_srsName) {\r\n    TC.filter.Filter.call(this, 'BBOX');\r\n    this.geometryName = geometryName;\r\n    this.extent = extent;\r\n    this.srsName = opt_srsName;\r\n};\r\nTC.inherit(TC.filter.Bbox, TC.filter.Spatial);\r\n\r\nTC.filter.Bbox.prototype.write = function () {\r\n    var bbox = '<gml:Envelope{srsName}><gml:lowerCorner>{lowerCorner}</gml:lowerCorner><gml:upperCorner>{upperCorner}</gml:upperCorner></gml:Envelope>'\r\n\t.format({\r\n\t    srsName: (typeof (this.srsName) !== \"undefined\" ? \" srsName=\\\"\" + this.srsName + \"\\\"\" : \"\"),\r\n\t    lowerCorner: (this.extent[0] + ' ' + this.extent[1]),\r\n\t    upperCorner: (this.extent[2] + ' ' + this.extent[3])\r\n\t});\r\n    var pattern = null;\r\n    if (this.geometryName)\r\n        pattern='<{prefix}:{tag}><{prefix}:{fieldTitle}>{name}</{prefix}:{fieldTitle}>{BBOX}</{prefix}:{tag}>';\r\n    else\r\n        pattern='<{prefix}:{tag}><{prefix}:{fieldTitle}/>{BBOX}</{prefix}:{tag}>';\r\n    return pattern.format({\r\n        prefix: this._defaultPrefixNS,\r\n        tag: this.getTagName(),\r\n        fieldTitle:  this._fieldTitle,\r\n        name: this.geometryName,\r\n        BBOX: bbox\r\n    });\r\n};\r\n\r\nTC.filter.Intersects = function (geometryName, geometry, opt_srsName) {\r\n    TC.filter.Spatial.call(this, 'Intersects', geometryName, geometry, opt_srsName);\r\n};\r\nTC.inherit(TC.filter.Intersects, TC.filter.Spatial);\r\n\r\nTC.filter.Within = function (geometryName, geometry, opt_srsName) {\r\n    TC.filter.Spatial.call(this, 'Within', geometryName, geometry, opt_srsName);\r\n};\r\nTC.inherit(TC.filter.Within, TC.filter.Spatial);"]}