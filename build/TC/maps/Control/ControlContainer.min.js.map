{"version":3,"sources":["control/ControlContainer.js"],"names":["TC","control","Container","syncLoadJS","apiLocation","ControlContainer","apply","this","arguments","_classSelector","CLASS","inherit","ctlProto","prototype","SIDE","LEFT","RIGHT","template","isDebug","dust","register","body_0","chk","ctx","write","section","get","block","body_1","body_3","helper","body_2","key","value","reference","body_4","w","f","__dustBody","onRenderPromise","self","bufferPromises","Array","ctlCount","Object","keys","controlOptions","forEach","i","ctl","map","addControl","Util","extend","id","uids","div","querySelector","options","Promise","all","then","len","length","containerControl","render","callback","_set1stRenderPromise","renderData","controls","index","side","resolve","reject","getRenderedHtml","html","document","createElement","innerHTML","trim","appendChild","content","firstChild","getUID","ctrl","addElement","li","setAttribute","addedElement","htmlElement","getAttribute"],"mappings":"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","sourcesContent":["TC.control = TC.control || {};\r\n\r\nif (!TC.control.Container) {\r\n    TC.syncLoadJS(TC.apiLocation + 'TC/Control/Container');\r\n}\r\n\r\nTC.control.ControlContainer = function () {\r\n    var self = this;\r\n\r\n    TC.control.Container.apply(self, arguments);\r\n\r\n    var cs = self._classSelector = '.' + self.CLASS;\r\n};\r\n\r\nTC.inherit(TC.control.ControlContainer, TC.control.Container);\r\n\r\n(function () {\r\n    var ctlProto = TC.control.ControlContainer.prototype;\r\n\r\n    ctlProto.CLASS = 'tc-ctl-cctr';\r\n    ctlProto.SIDE = {\r\n        LEFT: \"left\",\r\n        RIGHT: \"right\"\r\n    };\r\n\r\n    ctlProto.template = {};\r\n    if (TC.isDebug) {        \r\n        ctlProto.template[ctlProto.CLASS] = TC.apiLocation + \"TC/templates/ControlContainer.html\";\r\n        ctlProto.template[ctlProto.CLASS + '-node'] = TC.apiLocation + \"TC/templates/ControlContainerNode.html\";\r\n    }\r\n    else {\r\n        ctlProto.template[ctlProto.CLASS] = function () { dust.register(ctlProto.CLASS, body_0); function body_0(chk, ctx) { return chk.write(\"<ul class=\\\"tc-ctl-cctr-left\\\">\").section(ctx.get(\"controls\"), ctx, { \"block\": body_1 }, null).write(\"</ul><ul class=\\\"tc-ctl-cctr-right\\\">\").section(ctx.get(\"controls\"), ctx, { \"block\": body_3 }, null).write(\"</ul>\"); } function body_1(chk, ctx) { return chk.helper(\"eq\", ctx, { \"block\": body_2 }, { \"key\": ctx.get(\"side\"), \"value\": \"left\" }); } function body_2(chk, ctx) { return chk.write(\"<li class=\\\"tc-ctl-cctr-elm tc-ctl-cctr-elm-\").reference(ctx.get(\"index\"), ctx, \"h\").write(\"\\\"><div></div></li>\"); } function body_3(chk, ctx) { return chk.helper(\"eq\", ctx, { \"block\": body_4 }, { \"key\": ctx.get(\"side\"), \"value\": \"right\" }); } function body_4(chk, ctx) { return chk.write(\"<li class=\\\"tc-ctl-cctr-elm tc-ctl-cctr-elm-\").reference(ctx.get(\"index\"), ctx, \"h\").write(\"\\\"><div></div></li>\"); } return body_0; };        \r\n        ctlProto.template[ctlProto.CLASS + '-node'] = function () { dust.register(ctlProto.CLASS + '-node', body_0); function body_0(chk, ctx) { return chk.w(\"<li class=\\\"tc-ctl-cctr-elm tc-ctl-cctr-elm-\").f(ctx.get([\"index\"], false), ctx, \"h\").w(\"\\\"><div></div></li>\"); } body_0.__dustBody = !0; return body_0 };\r\n    }\r\n\r\n    ctlProto.onRenderPromise = function () {\r\n        const self = this;\r\n\r\n        var bufferPromises = new Array(self.ctlCount);\r\n\r\n        Object.keys(self.controlOptions).forEach(function (key, i) {\r\n            var ctl = self.controlOptions[key];            \r\n            bufferPromises[i] = self.map.addControl(key, TC.Util.extend({\r\n                id: self.uids[i],\r\n                div: self.div.querySelector('.' + self.CLASS + '-elm-' + i).querySelector('div')\r\n            }, ctl.options));\r\n        });\r\n\r\n        Promise.all(bufferPromises).then(function () {\r\n            for (var i = 0, len = arguments.length; i < len; i++) {\r\n                var ctl = arguments[i];\r\n                ctl.containerControl = self;\r\n            }\r\n        });\r\n    };\r\n\r\n    ctlProto.render = function (callback) {\r\n        const self = this;\r\n        return self._set1stRenderPromise(self.renderData({\r\n            controls: Object.keys(self.controlOptions).map(function (key, i) {\r\n                return TC.Util.extend(self.controlOptions[key], { index: i });\r\n            })\r\n        }));\r\n    };\r\n\r\n    ctlProto.addControl = function (control, options) {\r\n        const self = this;\r\n        options.side = options.side || self.SIDE.LEFT;\r\n\r\n        return new Promise(function (resolve, reject) {\r\n            self.getRenderedHtml(self.CLASS + '-node', { index: ++self.ctlCount }, function (html) {\r\n                var template = document.createElement('template');\r\n                template.innerHTML = html.trim();\r\n\r\n                self.div.querySelector('ul.' + self.CLASS + '-' + options.side).appendChild(template.content ? template.content.firstChild : template.firstChild);\r\n                self.map.addControl(control, TC.Util.extend({\r\n                    id: self.getUID(),\r\n                    div: self.div.querySelector('.' + self.CLASS + '-elm-' + self.ctlCount).querySelector('div')\r\n                }, options)).then(function (ctrl) {\r\n                    resolve(ctrl);\r\n                });\r\n            });\r\n        });\r\n    };\r\n\r\n    ctlProto.addElement = function (options) {\r\n        const self = this;\r\n\r\n        options.side = options.side || self.SIDE.LEFT;\r\n\r\n        var li = document.createElement('li');\r\n        li.setAttribute('class', (self.CLASS + '-elm ') + (self.CLASS + '-elm-' + self.ctlCount++ + ' '));\r\n\r\n        self.div.querySelector('ul.' + self.CLASS + '-' + options.side).appendChild(li);\r\n\r\n        var addedElement = li.appendChild(options.htmlElement);\r\n        addedElement.setAttribute('class', addedElement.getAttribute('class') + ' tc-ctl');\r\n        return addedElement;\r\n    };\r\n})();\r\n"]}