{"version":3,"sources":["control/Print.js"],"names":["TC","control","Consts","classes","PRINTABLE","Print","options","self","this","opts","ready","title","Util","getLocaleString","Cfg","locale","cssUrl","apiLocation","target","querySelector","CLASS","printableElement","classList","add","Control","prototype","getRenderedHtml","call","then","out","insertAdjacentHTML","addEventListener","e","page","open","content","innerHTML","document","write","close","focus","catch","err","error","bind","ctlProto","template","dust","register","body_0","chk","ctx","w","h","$key","__dustBody","f","get"],"mappings":"AAAAA,GAAGC,QAAUD,GAAGC,SAAW,GAE3BD,GAAGE,OAAOC,QAAQC,UAAY,eAK9BJ,GAAGC,QAAQI,MAAQ,SAAUC,GAEzB,IAAIC,EAAOC,KACPC,EAAOH,GAAW,GAEtBC,EAAKG,OAAQ,EAEbH,EAAKI,MAAQF,EAAKE,OAASX,GAAGY,KAAKC,gBAAgBb,GAAGc,IAAIC,OAAQ,aAClER,EAAKS,OAASP,EAAKO,QAAUhB,GAAGiB,YAAc,mBAE9C,GAAIR,EAAKS,OACT,CACI,MAAMA,EAAST,EAAKS,OAEpB,IAAKA,EAAOC,cAAc,IAAMZ,EAAKa,MAAQ,QAAS,EAMjDX,EAAKY,kBAAoBH,GAAQI,UAAUC,IAAIvB,GAAGE,OAAOC,QAAQC,WAelEJ,GAAGwB,QAAQC,UAAUC,gBAAgBC,KAAKpB,EAAMA,EAAKa,MAAO,MAAMQ,KAAK,SAAUC,GAC7EX,EAAOY,mBAAmB,aAAcD,GACxCX,EAAOC,cAAc,IAAMZ,EAAKa,MAAQ,QAAQW,iBAAiB,QAfpD,SAAUC,GACvB,IAAIC,EAAOC,KAAK,KAAM3B,EAAKa,OACvBe,GAAW1B,EAAKY,kBAAoBH,GAAQkB,UAChDpC,GAAGwB,QAAQC,UAAUC,gBAAgBC,KAAKpB,EAAMA,EAAKa,MAAQ,QAAS,CAAET,MAAOJ,EAAKI,MAAOwB,QAASA,EAASnB,OAAQT,EAAKS,SACrHY,KAAK,SAAUC,GACZI,EAAKI,SAASC,MAAMT,GACpBI,EAAKI,SAASE,QACdN,EAAKO,UAERC,MAAM,SAAUC,GACb1C,GAAG2C,MAAMD,MAKoEE,KAAKrC,UAM1G,WACI,IAAIsC,EAAW7C,GAAGC,QAAQI,MAAMoB,UAEhCoB,EAASzB,MAAQ,eAEjByB,EAASC,SAAW,GACpBD,EAASC,SAASD,EAASzB,OAAS,WAAW2B,KAAKC,SAASH,EAASzB,MAAM6B,GAAQ,SAASA,EAAOC,EAAIC,GAAK,OAAOD,EAAIE,EAAE,uCAA0CC,EAAE,OAAOF,EAAI,GAAG,CAACG,KAAO,oBAAoBF,EAAE,MAAOC,EAAE,OAAOF,EAAI,GAAG,CAACG,KAAO,UAAUF,EAAE,QAASH,EAAOM,YAAW,EAAG,OAAON,GAClSJ,EAASC,SAASD,EAASzB,MAAQ,SAAW,WAAW2B,KAAKC,SAASH,EAASzB,MAAQ,QAAQ6B,GAAQ,SAASA,EAAOC,EAAIC,GAAK,OAAOD,EAAIE,EAAE,2EAA6EI,EAAEL,EAAIM,IAAI,CAAC,UAAU,GAAON,EAAI,KAAKC,EAAE,yCAA4CI,EAAEL,EAAIM,IAAI,CAAC,WAAW,GAAON,EAAI,KAAKC,EAAE,oEAAyEI,EAAEL,EAAIM,IAAI,CAAC,UAAU,GAAON,EAAI,KAAKC,EAAE,SAASI,EAAEL,EAAIM,IAAI,CAAC,YAAY,GAAON,EAAI,IAAI,CAAC,MAAMC,EAAE,kBAAmBH,EAAOM,YAAW,EAAG,OAAON,GAPjjB","sourcesContent":["TC.control = TC.control || {};\r\n\r\nTC.Consts.classes.PRINTABLE = 'tc-printable';\r\n\r\n\r\n\r\n\r\nTC.control.Print = function (options)\r\n{\r\n    var self = this;\r\n    var opts = options || {};\r\n\r\n    self.ready = false;\r\n\r\n    self.title = opts.title || TC.Util.getLocaleString(TC.Cfg.locale, 'printPage');\r\n    self.cssUrl = opts.cssUrl || TC.apiLocation + 'TC/css/print.css';\r\n\r\n    if (opts.target)\r\n    {\r\n        const target = opts.target;\r\n\r\n        if (!target.querySelector('.' + self.CLASS + '-btn')) {\r\n            //for (var key in self.template) {\r\n            //    if (!dust.cache[key]) {\r\n            //        self.template[key]();\r\n            //    }\r\n            //}\r\n            (opts.printableElement || target).classList.add(TC.Consts.classes.PRINTABLE);\r\n\r\n            var renderPage = function (e) {\r\n                var page = open(null, self.CLASS);\r\n                var content = (opts.printableElement || target).innerHTML;\r\n                TC.Control.prototype.getRenderedHtml.call(self, self.CLASS + '-page', { title: self.title, content: content, cssUrl: self.cssUrl })\r\n                    .then(function (out) {\r\n                        page.document.write(out);\r\n                        page.document.close();\r\n                        page.focus();\r\n                    })\r\n                    .catch(function (err) {\r\n                        TC.error(err);\r\n                    });\r\n            };\r\n            TC.Control.prototype.getRenderedHtml.call(self, self.CLASS, null).then(function (out) {\r\n                target.insertAdjacentHTML('afterbegin', out);\r\n                target.querySelector('.' + self.CLASS + '-btn').addEventListener('click', renderPage.bind(self));\r\n            });\r\n        }\r\n    }\r\n};\r\n\r\n(function () {\r\n    var ctlProto = TC.control.Print.prototype;\r\n\r\n    ctlProto.CLASS = 'tc-ctl-print';\r\n\r\n    ctlProto.template = {};\r\n    ctlProto.template[ctlProto.CLASS] = TC.apiLocation + \"TC/templates/Print.html\";\r\n    ctlProto.template[ctlProto.CLASS + '-page'] = TC.apiLocation + \"TC/templates/PrintPage.html\";\r\n\r\n})();"]}