TC.control=TC.control||{};TC.control.FeatureInfoCommons||TC.syncLoadJS(TC.apiLocation+"TC/control/FeatureInfoCommons");TC.filter||TC.syncLoadJS(TC.apiLocation+"TC/Filter");!function(){TC.control.GeometryFeatureInfo=function(){TC.control.FeatureInfoCommons.apply(this,arguments);this.wrap=new TC.wrap.control.GeometryFeatureInfo(this);this.lineColor=this.options.lineColor?this.options.lineColor:"#c00";this._isDrawing=!1;this._isSearching=!1;this._drawToken=!1};TC.inherit(TC.control.GeometryFeatureInfo,TC.control.FeatureInfoCommons);var e=TC.control.GeometryFeatureInfo.prototype;e.register=function(e){const o=this,t=TC.control.FeatureInfoCommons.prototype.register.call(o,e);o.on(TC.Consts.event.CONTROLDEACTIVATE,function(e){o.wrap.cancelDraw()});return t};e.callback=function(e,o){var t=this;if(!t._drawToken){t.closeResults();for(var r=!1,n=0;n<t.map.workLayers.length;n++){var a=t.map.workLayers[n];if(a.type===TC.Consts.layerType.WMS&&a.getVisibility()&&a.names.length>0){r=!0;break}}if(r){t.closeResults();t.wrap.beginDraw({geometryType:t.geometryType,xy:e,layer:t.filterLayer,callback:function(e){t.wrap.getFeaturesByGeometry(e)}})}}};e.responseCallback=function(e){var o=this;TC.control.FeatureInfoCommons.prototype.responseCallback.call(o,e);if(o.filterFeature){for(var t=e.services,r=0;r<t.length;r++){var n=t[r];if(n.hasLimits){delete n.layers;n.hasLimits=n.hasLimits}else{for(var a=0;a<n.layers.length;a++)if(!n.layers[a].features.length){n.layers.splice(a,1);a-=1}if(!n.layers.length){t.splice(r,1);r-=1}}}t.length?o.renderData(e,function(){o.insertLinks();o.displayResults()}):o.resultsLayer.clearFeatures()}}}();
//# sourceMappingURL=../maps/control/GeometryFeatureInfo.min.js.map
