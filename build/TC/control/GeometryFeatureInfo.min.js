TC.control=TC.control||{};TC.control.FeatureInfoCommons||TC.syncLoadJS(TC.apiLocation+"TC/control/FeatureInfoCommons");TC.filter||TC.syncLoadJS(TC.apiLocation+"TC/Filter");!function(){TC.control.GeometryFeatureInfo=function(){TC.control.FeatureInfoCommons.apply(this,arguments);this.wrap=new TC.wrap.control.GeometryFeatureInfo(this);this._isDrawing=!1;this._isSearching=!1;this._drawToken=!1};TC.inherit(TC.control.GeometryFeatureInfo,TC.control.FeatureInfoCommons);var e=TC.control.GeometryFeatureInfo.prototype;e.register=function(e){const t=this,o=TC.control.FeatureInfoCommons.prototype.register.call(t,e);t.on(TC.Consts.event.CONTROLDEACTIVATE,function(e){t.wrap.cancelDraw()});return o};e.callback=function(e,t){var o=this;if(!o._drawToken){o.closeResults();o.highlightedFeature=null;for(var r=!1,n=0;n<o.map.workLayers.length;n++){var a=o.map.workLayers[n];if(a.type===TC.Consts.layerType.WMS&&a.getVisibility()&&a.names.length>0){r=!0;break}}if(r){o.closeResults();o.wrap.beginDraw({geometryType:o.geometryType,xy:e,layer:o.filterLayer,callback:function(e){o.wrap.getFeaturesByGeometry(e)}})}}};e.responseCallback=function(e){var t=this;TC.control.FeatureInfoCommons.prototype.responseCallback.call(t,e);if(t.filterFeature){for(var o=e.services,r=0;r<o.length;r++){var n=o[r];if(n.hasLimits){delete n.layers;n.hasLimits=n.hasLimits}else{for(var a=0;a<n.layers.length;a++)if(!n.layers[a].features.length){n.layers.splice(a,1);a-=1}if(!n.layers.length){o.splice(r,1);r-=1}}}t.renderData(e,function(){o.length&&t.insertLinks();t.div.querySelector(`.${t.CLASS}-coords`).classList.add(TC.Consts.classes.HIDDEN);t.displayResults()})}}}();
//# sourceMappingURL=../maps/control/GeometryFeatureInfo.min.js.map