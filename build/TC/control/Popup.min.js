TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.Consts.event.POPUP=TC.Consts.event.POPUP||"popup.tc";TC.Consts.event.POPUPHIDE=TC.Consts.event.POPUPHIDE||"popuphide.tc";TC.Consts.classes.DRAG=TC.Consts.classes.DRAG||"tc-drag";TC.Consts.classes.DRAGGED=TC.Consts.classes.DRAGGED||"tc-dragged";TC.Consts.classes.DRAGGABLE=TC.Consts.classes.DRAGGABLE||"tc-draggable";TC.control.Popup=function(){TC.Control.apply(this,arguments);this.currentFeature=null;this.wrap=new TC.wrap.control.Popup(this)};TC.inherit(TC.control.Popup,TC.Control);!function(){var t=TC.control.Popup.prototype;t.CLASS="tc-ctl-popup";t.render=function(){const t=this;return t._set1stRenderPromise(new Promise(function(s,e){t.map.wrap.addPopup(t).then(function(){t.trigger(TC.Consts.event.CONTROLRENDER);s()},function(t){e(t instanceof Error?t:Error(t))})}))};t.register=function(t){const s=this,e=TC.Control.prototype.register.call(s,t);return new Promise(function(n,i){Promise.all([e,s.renderPromise()]).then(function(){t.on(TC.Consts.event.VIEWCHANGE,function(){t.view===TC.Consts.view.PRINTING&&s.isVisible()&&s.hide()});t.on(TC.Consts.event.LAYERVISIBILITY,function(t){s.currentFeature&&s.currentFeature.layer===t.layer&&!t.layer.getVisibility()&&s.isVisible()&&s.hide()});t.on(TC.Consts.event.LAYERREMOVE,function(t){s.currentFeature&&s.currentFeature.layer===t.layer&&s.isVisible()&&s.hide()});t.on(TC.Consts.event.UPDATE,function(){s.currentFeature&&s.currentFeature._visibilityState!==TC.Consts.visibility.NOT_VISIBLE||s.isVisible()&&s.hide()});t.on(TC.Consts.event.FEATUREREMOVE,function(t){s.currentFeature===t.feature&&s.isVisible()&&s.hide()});n(s)}).catch(function(t){i(t instanceof Error?t:Error(t))})})};t.fitToView=function(t){var s=this;t?setTimeout(function(){s.wrap.fitToView()},1e3):s.wrap.fitToView()};t.hide=function(){if(this.map){this.map.wrap.hidePopup(this);this.setDragged(!1);this.map.trigger(TC.Consts.event.POPUPHIDE,{control:this})}};t.getContainerElement=function(){return this.contentDiv||null};t.getMenuElement=function(){return this.menuDiv||null};t.setDragged=function(t){const s=this;s.dragged=t;s.popupDiv&&(t?s.popupDiv.classList.add(TC.Consts.classes.DRAGGED):s.popupDiv.classList.remove(TC.Consts.classes.DRAGGED));s.wrap.setDragged(t)};t.setDragging=function(t){const s=this;if(t){s.setDragged(!0);s.popupDiv.classList.add(TC.Consts.classes.DRAG)}else s.popupDiv.classList.remove(TC.Consts.classes.DRAG)};t.isVisible=function(){return this.popupDiv&&this.popupDiv.classList.contains(TC.Consts.classes.VISIBLE)}}();
//# sourceMappingURL=../maps/Control/Popup.min.js.map
