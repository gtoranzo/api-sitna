TC.control=TC.control||{};TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control");TC.Consts.event.POPUP=TC.Consts.event.POPUP||"popup.tc";TC.Consts.event.POPUPHIDE=TC.Consts.event.POPUPHIDE||"popuphide.tc";TC.Consts.classes.DRAG=TC.Consts.classes.DRAG||"tc-drag";TC.Consts.classes.DRAGGED=TC.Consts.classes.DRAGGED||"tc-dragged";TC.Consts.classes.DRAGGABLE=TC.Consts.classes.DRAGGABLE||"tc-draggable";TC.control.Popup=function(){TC.Control.apply(this,arguments);this.currentFeature=null;this.wrap=new TC.wrap.control.Popup(this)};TC.inherit(TC.control.Popup,TC.Control);!function(){var t=TC.control.Popup.prototype;t.CLASS="tc-ctl-popup";t.render=function(){const t=this;return t._set1stRenderPromise(new Promise(function(e,s){t.map.wrap.addPopup(t).then(function(){t.trigger(TC.Consts.event.CONTROLRENDER);e()},function(t){s(t instanceof Error?t:Error(t))})}))};t.register=function(t){const e=this,s=TC.Control.prototype.register.call(e,t);return new Promise(function(n,i){Promise.all([s,e.renderPromise()]).then(function(){t.on(TC.Consts.event.VIEWCHANGE,function(){t.view===TC.Consts.view.PRINTING&&e.isVisible()&&e.hide()});t.on(TC.Consts.event.LAYERVISIBILITY,function(t){e.currentFeature&&e.currentFeature.layer===t.layer&&!t.layer.getVisibility()&&e.isVisible()&&e.hide()});t.on(TC.Consts.event.LAYERREMOVE,function(t){e.currentFeature&&e.currentFeature.layer===t.layer&&e.isVisible()&&e.hide()});t.on(TC.Consts.event.UPDATE,function(){e.currentFeature&&e.currentFeature._visibilityState!==TC.Consts.visibility.NOT_VISIBLE||e.isVisible()&&e.hide()});t.on(TC.Consts.event.FEATUREREMOVE,function(t){e.currentFeature===t.feature&&e.isVisible()&&e.hide()});n(e)}).catch(function(t){i(t instanceof Error?t:Error(t))})})};t.fitToView=function(t){var e=this;t?setTimeout(function(){e.wrap.fitToView()},1e3):e.wrap.fitToView()};t.hide=function(){if(this.map){const t={control:this,feature:this.currentFeature};this.map.wrap.hidePopup(this);this.setDragged(!1);this.map.trigger(TC.Consts.event.POPUPHIDE,t)}};t.getContainerElement=function(){return this.contentDiv||null};t.getMenuElement=function(){return this.menuDiv||null};t.setDragged=function(t){const e=this;e.dragged=t;e.popupDiv&&e.popupDiv.classList.toggle(TC.Consts.classes.DRAGGED,!!t);e.wrap.setDragged(t)};t.setDragging=function(t){const e=this;if(t){e.setDragged(!0);e.popupDiv.classList.add(TC.Consts.classes.DRAG)}else e.popupDiv.classList.remove(TC.Consts.classes.DRAG)};t.isVisible=function(){return this.popupDiv&&this.popupDiv.classList.contains(TC.Consts.classes.VISIBLE)}}();
//# sourceMappingURL=../maps/control/Popup.min.js.map