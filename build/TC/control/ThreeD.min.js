TC.control=TC.control||{};!function(){TC.control.ThreeD=function(){TC.Control.apply(this,arguments)};TC.inherit(TC.control.ThreeD,TC.Control);var t=TC.control.ThreeD.prototype;t.CLASS="tc-ctl-threed";t.classes={BETA:"tc-beta-button",BTNACTIVE:"active"};t.template=function(){dust.register(t.CLASS,e);function e(t,e){return t.w('<button class="tc-ctl-threed-btn tc-beta-button" title="').h("i18n",e,{},{$key:"threed.tip"}).w('"></button>')}e.__dustBody=!0;return e};t.register=function(t){const e=this,o=TC.Control.prototype.register.call(e,t);t.on(TC.Consts.event.VIEWCHANGE,function(t){t.view==TC.Consts.view.THREED&&e.activate()});return o};t.renderData=function(t,e){const o=this;return TC.Control.prototype.renderData.call(o,t,function(){o.button=o.div.querySelector("."+o.CLASS+"-btn");o.button.addEventListener(TC.Consts.event.CLICK,function(){if(!o.button.disabled)if(o.map.on3DView){o.button.disabled=!0;TC.view.ThreeD.unapply({callback:function(){o.button.setAttribute("title",o.getLocaleString("threed.tip"));o.button.classList.remove(o.classes.BTNACTIVE);o.button.disabled=!1}})}else o.activate()});TC.Util.isFunction(e)&&e()})};t.activate=function(){var t=this;t.button.disabled=!0;t.browserSupportWebGL.call(t);const e=function(){t.button.disabled=!1};t.map.view3D?t.map.on3DView||TC.view.ThreeD.apply({map:t.map,options:t.options,getRenderedHtml:t.getRenderedHtml,callback:e}):TC.loadJS(!TC.view||!TC.view.ThreeD,TC.apiLocation+"TC/view/ThreeD",function(){TC.view.ThreeD.apply({map:t.map,options:t.options,getRenderedHtml:t.getRenderedHtml,callback:e})});!function(){t.button.setAttribute("title",t.getLocaleString("threed.two.tip"));t.button.classList.remove(t.classes.BETA);t.button.classList.add(t.classes.BTNACTIVE)}()};t.deactivate=function(){TC.Control.prototype.deactivate.call(this)};t.browserSupportWebGL=function(){var t=!1;if(window.WebGLRenderingContext){var e=document.createElement("canvas"),o={alpha:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};try{var n=e.getContext("webgl",o)||e.getContext("experimental-webgl",o)||e.getContext("webkit-3d",o)||e.getContext("moz-webgl",o);if(n)t=!0;else{o.failIfMajorPerformanceCaveat=!1;if(n=e.getContext("webgl",o)||e.getContext("experimental-webgl",o)||e.getContext("webkit-3d",o)||e.getContext("moz-webgl",o)){t="slow";this.isSlower=!0}else t=!1}}catch(t){console.log(E)}if("slow"===t||!t){var i="slow"===t?"threed.slowSupport.supported":"threed.not.supported";this.map.toast(this.getLocaleString(i),{type:TC.Consts.msgType.WARNING,duration:1e4})}return t}t=!1}}();
//# sourceMappingURL=../maps/control/ThreeD.min.js.map