TC.control=TC.control||{};TC.control.FeatureInfoCommons||TC.syncLoadJS(TC.apiLocation+"TC/control/FeatureInfoCommons");!function(){TC.control.MultiFeatureInfo=function(){this.lineColor=null;TC.Control.apply(this,arguments);this.modes=this.options.modes||{};void 0===this.modes[TC.Consts.geom.POINT]&&(this.modes[TC.Consts.geom.POINT]=!0);void 0===this.modes[TC.Consts.geom.POLYGON]&&(this.modes[TC.Consts.geom.POLYGON]=!0);this.fInfoCtrl=null;this.lineFInfoCtrl=null;this.polygonFInfoCtrl=null;this.lastCtrlActive=null;this.popup=null;this.exportsState=!1};TC.inherit(TC.control.MultiFeatureInfo,TC.control.FeatureInfoCommons);var t=TC.control.MultiFeatureInfo.prototype;t.CLASS="tc-ctl-m-finfo";TC.isDebug?t.template=TC.apiLocation+"TC/templates/MultiFeatureInfo.html":t.template=function(){dust.register(t.CLASS,e);function e(t,e){return t.w('<div class="tc-ctl-m-finfo-select"><form><span>').h("i18n",e,{},{$key:"selection"}).w("</span>").x(e.get(["pointSelectValue"],!1),e,{block:o},{}).x(e.get(["lineSelectValue"],!1),e,{block:n},{}).x(e.get(["polygonSelectValue"],!1),e,{block:l},{}).w("</form></div>")}e.__dustBody=!0;function o(t,e){return t.w('<label class="tc-ctl-m-finfo-btn-point" title="').h("i18n",e,{},{$key:"selectionByPoint"}).w('"><input type="radio" name="selectmode" value="').f(e.get(["pointSelectValue"],!1),e,"h").w('" checked /><span class="tc-ctl-btn">').h("i18n",e,{},{$key:"byPoint"}).w("</span></label>")}o.__dustBody=!0;function n(t,e){return t.w('<label class="tc-ctl-m-finfo-btn-line" title="').h("i18n",e,{},{$key:"selectionByLine"}).w('"><input type="radio" name="selectmode" value="').f(e.get(["lineSelectValue"],!1),e,"h").w('" /><span class="tc-ctl-btn">').h("i18n",e,{},{$key:"byLine"}).w("</span></label>")}n.__dustBody=!0;function l(t,e){return t.w('<label class="tc-ctl-m-finfo-btn-polygon" title="').h("i18n",e,{},{$key:"selectionByPrecinct"}).w('"><input type="radio" name="selectmode" value="').f(e.get(["polygonSelectValue"],!1),e,"h").w('" /><span class="tc-ctl-btn">').h("i18n",e,{},{$key:"byPrecinct"}).w("</span></label>")}l.__dustBody=!0;return e};const e=function(t,e){if(!0===t){t={};return TC.Util.extend(t,e)}return t};t.register=function(t){const o=this;o.div.querySelectorAll("input[type=radio]").forEach(function(t){t.checked=!1});return new Promise(function(n,l){const i=[TC.Control.prototype.register.call(o,t)];o.modes[TC.Consts.geom.POINT]&&i.push(t.addControl("featureInfo",e(o.modes[TC.Consts.geom.POINT],{displayMode:o.options.displayMode})).then(function(t){o.fInfoCtrl=t;return t}));o.modes[TC.Consts.geom.POLYLINE]&&i.push(t.addControl("lineFeatureInfo",e(o.modes[TC.Consts.geom.POLYLINE],{displayMode:o.options.displayMode,lineColor:o.lineColor})).then(function(t){o.lineFInfoCtrl=t;return t}));o.modes[TC.Consts.geom.POLYGON]&&i.push(t.addControl("polygonFeatureInfo",e(o.modes[TC.Consts.geom.POLYGON],{displayMode:o.options.displayMode,lineColor:o.lineColor})).then(function(t){o.polygonFInfoCtrl=t;return t}));t.on(`${TC.Consts.event.LAYERADD} ${TC.Consts.event.LAYERREMOVE} ${TC.Consts.event.LAYERVISIBILITY}`,function(t){o.updateUI()});t.on(`${TC.Consts.event.CONTROLACTIVATE} ${TC.Consts.event.CONTROLDEACTIVATE}`,function(t){t.control!==o.fInfoCtrl&&t.control!==o.lineFInfoCtrl&&t.control!==o.polygonFInfoCtrl||o.updateUI()});Promise.all(i).then(function(){if(o.fInfoCtrl){o.fInfoCtrl.activate();o.lastCtrlActive=o.fInfoCtrl}o.updateUI();n(o)})})};t.render=function(t){const e=this;e.lineColor=e.options.lineColor?e.options.lineColor:"#c00";var o={};e.modes[TC.Consts.geom.POINT]&&(o.pointSelectValue=TC.Consts.geom.POINT);e.modes[TC.Consts.geom.POLYLINE]&&(o.lineSelectValue=TC.Consts.geom.POLYLINE);e.modes[TC.Consts.geom.POLYGON]&&(o.polygonSelectValue=TC.Consts.geom.POLYGON);return TC.Control.prototype.renderData.call(e,o,function(){var o=function(){switch(this.value){case TC.Consts.geom.POLYLINE:e.lineFInfoCtrl.activate();e.lastCtrlActive=e.lineFInfoCtrl;break;case TC.Consts.geom.POLYGON:e.polygonFInfoCtrl.activate();e.lastCtrlActive=e.polygonFInfoCtrl;break;default:e.fInfoCtrl.activate();e.lastCtrlActive=e.fInfoCtrl}};e.div.querySelectorAll("input[type=radio]").forEach(function(t){t.addEventListener("change",o)});TC.Util.isFunction(t)&&t()})};t.activate=function(){this.lastCtrlActive&&this.lastCtrlActive.activate()};t.deactivate=function(){this.lastCtrlActive.deactivate(!1)};t.updateUI=function(){const t=this;if(t.map){const e=t.map.workLayers.some(t=>t.type===TC.Consts.layerType.WMS&&t.getVisibility());t.div.querySelectorAll("input").forEach(function(t){t.disabled=!e});if(t.fInfoCtrl){const e=t.div.querySelector(`input[value=${TC.Consts.geom.POINT}]`);e&&(e.checked=t.fInfoCtrl.isActive)}if(t.lineFInfoCtrl){const e=t.div.querySelector(`input[value=${TC.Consts.geom.POLYLINE}]`);e&&(e.checked=t.lineFInfoCtrl.isActive)}if(t.polygonFInfoCtrl){const e=t.div.querySelector(`input[value=${TC.Consts.geom.POLYGON}]`);e&&(e.checked=t.polygonFInfoCtrl.isActive)}const o=t.div.style.display;t.div.style.display="none";o?t.div.style.display=o:t.div.style.removeProperty("display")}}}();
//# sourceMappingURL=../maps/control/MultiFeatureInfo.min.js.map